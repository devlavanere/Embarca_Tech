# Cap√≠tulo 2: Modelos Multitarefa em Aplica√ß√µes em Sistemas Embarcados

Este cap√≠tulo aprofunda os modelos multitarefa, abordando desde as estruturas mais simples at√© t√©cnicas avan√ßadas de comunica√ß√£o e sincroniza√ß√£o em sistemas embarcados. Exploramos o **Superloop**, **Foreground/Background** e a utiliza√ß√£o de **m√∫ltiplos n√∫cleos (Multicore)** na **BitDogLab (Raspberry Pi Pico W)**.

---

## T√≥picos Abordados

* **Modelos Multitarefa Fundamentais**:
    * **Superloop**: Estrutura b√°sica onde as tarefas s√£o executadas em sequ√™ncia cont√≠nua.
    * **Foreground/Background**: Modelo que utiliza interrup√ß√µes para tratar eventos ass√≠ncronos, enquanto o la√ßo principal executa tarefas rotineiras.
* **Sincroniza√ß√£o e Comunica√ß√£o**:
    * Uso de **vari√°veis globais** entre ISRs e o loop principal.
    * Implementa√ß√£o de **filas circulares** para comunica√ß√£o Produtor/Consumidor.
* **Concorr√™ncia e Exclus√£o M√∫tua**:
    * Utiliza√ß√£o de **spinlocks** no RP2040 para proteger se√ß√µes cr√≠ticas.
* **Multicore no RP2040**:
    * Execu√ß√£o de **tarefas simult√¢neas em dois n√∫cleos**.
    * **Comunica√ß√£o entre n√∫cleos** via FIFO (First-In, First-Out).

---

## üõ†Ô∏è Atividades e Experimentos Pr√°ticos na BitDogLab

### 1. Implementa√ß√£o de Modelos Multitarefa B√°sicos

* **Superloop - Piscar LED e Ler Bot√£o**:
    * **Objetivo**: Demonstrar a estrutura de um sistema com superloop.
    * **Funcionamento**: Tarefas executadas em sequ√™ncia fixa e cont√≠nua, sem interrup√ß√µes nem temporizadores.
* **Foreground/Background - Interrup√ß√£o por Bot√£o**:
    * **Objetivo**: Implementar o modelo Foreground/Background.
    * **Funcionamento**: Tarefas rotineiras no la√ßo principal e eventos ass√≠ncronos tratados por interrup√ß√µes para respostas imediatas.

### 2. Explora√ß√£o de Exemplos Avan√ßados de Multitarefa

* **Cooperativo - Temporizador com `add_alarm_in_ms()`**:
    * Demonstra√ß√£o de temporizador cooperativo baseado em callback, controlando o piscar de um LED.
* **Variavel\_global\_entre\_ISR\_loop - Comunica√ß√£o por Vari√°vel Global**:
    * Uso de uma vari√°vel global para comunica√ß√£o entre uma rotina de interrup√ß√£o (ISR) e o la√ßo principal.
* **Fila\_circular - Simula√ß√£o de Fila Circular (produtor/consumidor)**:
    * Simula√ß√£o de uma fila circular em C para o padr√£o produtor-consumidor sem RTOS, operando cooperativamente.
* **Led\_dinamico\_btn - Controle de Tempo com Bot√£o (LED din√¢mico)**:
    * Permite alterar o tempo de piscar do LED dinamicamente usando um bot√£o.
* **Mutex\_spinlock\_rp2040 - Exclus√£o M√∫tua com Spinlock**:
    * Utiliza√ß√£o de spinlocks no RP2040 para proteger se√ß√µes cr√≠ticas em ambientes concorrentes.
* **Multitask\_2core - Multitarefa com Dois N√∫cleos**:
    * Uso dos dois n√∫cleos do RP2040 para tarefas simult√¢neas (Core 0 controla LED, Core 1 imprime mensagens).
* **Multicore\_fifo\_troca - Multitarefa com Dois N√∫cleos (FIFO)**:
    * Comunica√ß√£o entre os dois n√∫cleos do RP2040 usando a FIFO interna para troca de valores sincronizada.

---

## üìö Conceitos-Chave

* **Superloop**: Estrutura simples, sequencial e cont√≠nua.
* **Foreground/Background**: Modelo com interrup√ß√µes para eventos r√°pidos e loop principal para rotinas.
* **Interrup√ß√£o (ISR)**: Rotina de servi√ßo de interrup√ß√£o que responde a eventos ass√≠ncronos.
* **Vari√°vel Global**: Meio de comunica√ß√£o entre diferentes partes do c√≥digo, incluindo ISRs.
* **Fila Circular**: Estrutura de dados para comunica√ß√£o eficiente entre processos ou tarefas.
* **Exclus√£o M√∫tua**: Mecanismo para garantir acesso exclusivo a recursos compartilhados.
* **Spinlock**: Um tipo de mecanismo de exclus√£o m√∫tua em ambientes multicore.
* **Multicore**: Arquitetura com m√∫ltiplos n√∫cleos de processamento, permitindo paralelismo real.
* **FIFO (First-In, First-Out)**: Estrutura de dados para comunica√ß√£o ordenada, utilizada entre os n√∫cleos do RP2040.

---

## üìù Atividades de Avalia√ß√£o

* **Question√°rio do Cap√≠tulo 2 no AVA**.
* **Entrega da Atividade Cap√≠tulo 2 no AVA**: "Aplica√ß√£o Multitarefa - Cria√ß√£o de uma Esta√ß√£o de Monitoramento Interativo".

---